apiVersion: extensions/v1beta1
kind: ReplicaSet
metadata:
  name: zoo-0
  namespace: kafka
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: zookeeper
        petindex: "0"
    spec:
      containers:
        - name: zookeeper
          image: zookeeper:3.4
          env:
            - name: ZOO_MY_ID
              value: "1"
            - name: ZOO_SERVERS
              value: server.1=0.0.0.0:2888:3888:participant server.2=zoo-1.kafka.svc.cluster.local:2888:3888:participant server.3=zoo-2.kafka.svc.cluster.local:2888:3888:participant
            - name: ZOO_INIT_LIMIT
              value: "10"
            - name: ZOO_SYNC_LIMIT
              value: "5"
          ports:
            - containerPort: 2181
              name: client
            - containerPort: 2888
              name: peer
            - containerPort: 3888
              name: leader-election
          readinessProbe:
            exec:
              command:
                - zkCli.sh
                - ls
                - /
            initialDelaySeconds: 15
            timeoutSeconds: 5
          volumeMounts:
            - name: datadir
              mountPath: /tmp/zookeeper
            - name: opt
              mountPath: /opt/
      volumes:
        - name: opt
          emptyDir: {}
        - name: datadir
          emptyDir: {}
